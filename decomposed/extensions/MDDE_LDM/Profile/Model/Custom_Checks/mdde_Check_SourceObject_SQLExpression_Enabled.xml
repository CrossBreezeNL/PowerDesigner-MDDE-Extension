<o:CustomCheckTargetItem Id="5E3AECB0-F77F-4B10-A1EB-6945FF0B889B">
<a:ObjectID>5E3AECB0-F77F-4B10-A1EB-6945FF0B889B</a:ObjectID>
<a:Name>mdde_Check_SourceObject_SQLExpression_Enabled</a:Name>
<a:CreationDate>1725533973</a:CreationDate>
<a:Creator>DijkC1</a:Creator>
<a:Comment>When window business rules are created we should also enable the export of the SQL expression. If this is enabled for sql expressions the source attributes will be used instead of the input attributes.</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:HelpMessage>This check ensures that if a windows Business Rule is modelled the SourceObject SQL expression is set.</a:HelpMessage>
<a:OutputMessage>The following objects do not pass custom check:</a:OutputMessage>
<a:CheckScript>Function %Check%(obj)
   %Check% = True
    
    &#39;check if one of the entities in the model is a windowbusinessrule.
    &#39;make sure to also do this for windows business rules that are implemented through a shortcut.
    Dim entity, windowBusinessRuleFound, realObject
    For Each entity in obj.GetCollection(&quot;Entities&quot;)
      If Not(entity Is Nothing) Then
         Set realObject = GetRealObject(entity)
         If not realObject Is Nothing Then
            If realObject.HasStereotype(&quot;mdde_WindowBusinessRule&quot;) Then
               If obj.GetExtendedAttributeText(&quot;mdde_Export_SourceObject_ExpressionBusinessRule_SqlExpression&quot;) = &quot;false&quot; Then
                  %Check% = False
                  WriteError &quot;Please enable Model Options for Export MDDE: SourceObject SQL Expression&quot;
               End If         
               Exit For
            End If
         End If
      End if
    Next
 
End Function</a:CheckScript>
<a:AutoFixScrpt>Function %Fix%(obj, outmsg)
   %Fix% = False
   
   obj.SetExtendedAttribute &quot;mdde_Export_SourceObject_ExpressionBusinessRule_SqlExpression&quot;, True
   If obj.GetExtendedAttributeText(&quot;mdde_Export_SourceObject_ExpressionBusinessRule_SqlExpression&quot;) = &quot;true&quot; Then      
      %Fix% = True
      outmsg = &quot;Automatic correction succesfull: Model Options for Export MDDE: SourceObject SQL Expression set&quot;
   Else
      %Fix% = False
      outmsg = &quot;Automatic correction not implemented&quot;
   End if
End Function

</a:AutoFixScrpt>
<a:EnableAutoFix>1</a:EnableAutoFix>
</o:CustomCheckTargetItem>