<o:MethodTargetItem Id="98A9ACE6-BE1A-441F-83E4-E80B8916B0C5">
<a:ObjectID>98A9ACE6-BE1A-441F-83E4-E80B8916B0C5</a:ObjectID>
<a:Name>mdde_import_from_excel</a:Name>
<a:CreationDate>1736328921</a:CreationDate>
<a:Creator>BasBosman</a:Creator>
<a:Comment>Import example data from Excel</a:Comment>
<a:TargetCategory.Type>1</a:TargetCategory.Type>
<a:MethodScript>Sub %Method%(obj)
   &#39; Implement your method on &lt;obj&gt; here
     Dim x1
     Dim wb
     Dim activeWorksheet
     
     Dim actModel : Set actModel = ActiveModel
     
     Dim path
     &#39;path = InputBox(&quot;Please Enter a FileName&quot;,,&quot;.xlsx&quot;)
     path =&quot;test.xlsx&quot;
     
     WriteInfo path
     
	  Set x1 = CreateObject(&quot;Excel.Application&quot;) 
	  x1.Visible = True 
     Set wb = x1.Workbooks.Open(&quot;test.xlsx&quot;)
     
     Dim objExampleEntityData2
     Dim exampleRecord
     Dim objExampleRec
     &#39;Delete current example records
     For Each objExampleEntityData2 In obj.getExtendedCollection(&quot;mdde_ExampleEntityData&quot;)
         For each objExampleRec in objExampleEntityData2.getExtendedCollection(&quot;mdde_ExampleRecords&quot;)
            objExampleRec.Delete
            WriteInfo &quot;Delete record &quot; &amp; objExampleRec.Code
         Next
     Next
     
     &#39;Add new example records
     Dim objWorksheet
        For Each objWorksheet In x1.Worksheets
        &#39;Search for corresponding objExampleEntityData
        Dim objExampleEntityData : Set objExampleEntityData = nothing
        Dim objExampleEntityData3
        Dim objEntity
        For each objExampleEntityData3 in obj.getExtendedCollection(&quot;mdde_ExampleEntityData&quot;)
         Set objEntity = objExampleEntityData3.getExtendedCollection(&quot;mdde_ExampleEntity&quot;).Item(0)
         If objEntity.Code = objWorksheet.Cells(1,1) then
            Set objExampleEntityData = objExampleEntityData3
            Exit for 
         End if
        Next
        If (objExampleEntityData is Nothing) then
            WriteInfo &quot;Entity &quot; &amp; objWorksheet.Cells(1,1) &amp; &quot; not found&quot;
            Exit for
        End if

        Dim recordCount : recordCount = 1 
        Dim nextRecord : nextRecord = true
        Dim totalAttributeCount : totalAttributeCount = 0
        
        Dim colExampleRec : Set colExampleRec = objExampleEntityData.GetExtendedCollection(&quot;mdde_ExampleRecords&quot;)
        Do while nextRecord
            &#39;Select next line
            Dim recordCode : recordCode = objWorksheet.Cells(recordCount + 1, 1)
            If recordCode &gt; &quot;&quot; then
               &#39;Create test record
               Dim objExampleRec2 : Set objExampleRec2 = colExampleRec.createNew()
               objExampleRec2.Code = recordCode
               objExampleRec2.Name = recordCode
               WriteInfo &quot;Created record: &quot; &amp; objExampleRec2.Name
               
               &#39;Get all attributes for the example record
               Dim attributeCount : attributeCount = 1
               Dim nextAttribute : nextAttribute = true
               
               Dim colExampleAttribute : Set colExampleAttribute = objExampleRec2.GetExtendedCollection(&quot;mdde_ExampleAttributeValues&quot;)
               
               Do while nextAttribute
                  &#39; Get attribute-code from header
                  Dim attributeCode : attributeCode = objWorksheet.Cells(1, attributeCount + 1)
                  Dim attributeValue : attributeValue = objWorksheet.Cells(recordCount + 1, attributeCount + 1)

                  
                  &#39; First record : count number of attributes
                  If recordCount = 1 then
                     If attributeCode &gt; &quot;&quot; then
                        &#39; Append attribute code to list with attributes
                        totalAttributeCount = attributeCount
                     Else
                        nextAttribute = false
                     End if
                  End if
                  
                  If nextAttribute then
                     &#39; write attribute here
                     Dim objExampleAttribute2 : Set objExampleAttribute2 = colExampleAttribute.createNew()
                     objExampleAttribute2.Code = attributeCode
                     objExampleAttribute2.Name = attributeCode
                     
                     &#39;search the actual attribute
                     Dim entityAttribute
                     For each entityAttribute in objEntity.attributes
                        If entityAttribute.Name = attributeCode then
                           Exit for
                        End if
                     Next
                     
                     objExampleAttribute2.SetExtendedAttribute &quot;mdde_Attribute&quot;, entityAttribute
                     objExampleAttribute2.SetExtendedAttribute &quot;mdde_Value&quot;, attributeValue
                     WriteInfo &quot;Created attribute: &quot; &amp; attributeCode &amp; &quot; - &quot; &amp; attributeValue
                  End if
                  
                  &#39; Subsequent records: check if we added all attributes
                  If (recordCount &gt; 1 and (attributeCount = totalAttributeCount)) then
                     nextAttribute = false
                  End if
                  attributeCount = attributeCount + 1
               Loop
               
               attributeCount = attributeCount + 1
            Else
               nextRecord = false
            End if
            
            &#39; Select next row in Excel
            recordCount = recordCount + 1      
        Loop
     Next
     
     x1.Workbooks.Close
End Sub</a:MethodScript>
</o:MethodTargetItem>